write.csv(Tested, "CountyData/CountyTests.csv")
write.csv(Positive, "CountyData/CountyPositive.csv")
write.csv(Recovered, "CountyData/CountyRecovered.csv")
write.csv(Deaths, "CountyData/CountyDeaths.csv")
write.csv(Active, "CountyData/CountyActive.csv")
colMax <- function(data) sapply(data, max, na.rm = TRUE)
covid19 <- read.csv("covid19.csv", stringsAsFactors = FALSE)
# covid19 <- read_excel("covid19.xlsx", sheet = 1)
county <- read.csv("censusCounties.csv", stringsAsFactors = FALSE)
# covid19 = covid19[-158,]
names(covid19)[names(covid19) == "Ã¯..date"] <- 'date'
# covid19$date <- mdy(covid19$date)
covid19$date <- ymd(covid19$date)
covid19$deaths = sapply(covid19$deaths, as.integer)
covid19 <-covid19 %>% mutate(
negative = Total.Tested - positive,
New.Positive = positive - lag(positive),
New.Negative = negative - lag(negative),
new.hospital = hospitalized - lag(hospitalized),
Total.Daily.Tests = Total.Tested - lag(Total.Tested),
New.Deaths = deaths - lag(deaths),
Still.Sick = positive - Recovered) %>% mutate(
New.Percent.Positive = New.Positive/Total.Daily.Tests,
Week.Positivity.Rate = (positive - lag(positive, n=7))/(Total.Tested - lag(Total.Tested, n=7)),
Percent.Hospitalized = hospitalized/Still.Sick
)
#rownames(covid19) <- covid19[,"date"]
#################################################
##  Fill in county Data in covid19
#################################################
numrows = nrow(BremerData)
numrows1 = nrow(Black.HawkData)
tempBr =   BremerData[numrows,
c("Positive", "Recovered","Deaths", "Active" )]
tempBl =   Black.HawkData[numrows1,
c("Positive", "Recovered","Deaths", "Active" )]
tempBu =   ButlerData[numrows1,
c("Positive", "Recovered","Deaths", "Active" )]
names(tempBr) = c("Bremer.Positive", "Bremer.Recovered",
"Bremer.Death", "Bremer.SS")
names(tempBu) = c("Butler.P", "Butler.R",
"Butler.D", "Butler.SS")
names(tempBl) = c("BlackHawk.P", "BlackHawk.R",
"BlackHawk.D", "BlackHawk.SS")
temp = cbind(tempBr, tempBu, tempBl)
for (i in names(temp)){
covid19[nrow(covid19),i] = temp[i]
}
write.csv(covid19, "covid19.csv",row.names = FALSE)
#################################################
##  Create Clean Dataset
#################################################
clearn <- !is.na(covid19$positive)
clean <- covid19[clearn,]
cdeaths <- covid19[!is.na(covid19$deaths),]
clean <- clean %>% mutate(
negative = Total.Tested - positive,
Percent.Pos = positive/Total.Tested*100,
#np_7day = rollmean(New.Positive, k=7, align = "right", fill = NA),
np_7day = (positive - lag(positive, n=7))/7,
New.Percent.Positive = New.Positive/Total.Daily.Tests,
Percent.Hospitalized = hospitalized/Still.Sick*100
)
clean <- clean %>% mutate(
#  np_7day = rollmean(New.Positive, k=7, align = "right", fill = NA),
#Week.Positivity = rollapply(New.Positive, 7, FUN=sum, fill = NA),
#Week.Tests = rollapply(Total.Daily.Tests, 7, FUN=sum, fill = NA),
Week.Positivity = positive - lag(positive, n=7),
Week.Tests = Total.Tested - lag(Total.Tested, n=7),
Week.Positivity.Rate = Week.Positivity/Week.Tests,
Week.Deaths = deaths - lag(deaths, n=7),
Day.Total.Tests = Total.Tests - lag(Total.Tests,n=1),
Day.Positive.Tests = Positive.Tests - lag(Positive.Tests, n=1),
Day.Bremer.Total.Tests = Bremer.Total.Tests - lag(Bremer.Total.Tests,n=1),
Day.Bremer.Positive.Tests = Bremer.Positive.Tests - lag(Bremer.Positive.Tests, n=1),
)
clean <- clean %>% mutate(wktot = Week.Positivity)
# clean$wktot <- sapply(clean$date,function(x)sum(clean[difftime(clean$date,x,,"days") %in% 0:-6,]$New.Positive))
lastrow <- nrow(clean)
clean$deaths = sapply(clean$deaths, as.integer)
clean <- clean %>% mutate(
nd_7day = deaths - lag(deaths, n=7), #rollmean(deaths, k=7, fill = NA,),
pp_7day = (positive - lag(positive, n=7))/ (Total.Tested - lag(Total.Tested, n=7))#
#rollmean(New.Percent.Positive, k=7, fill = NA)
)
today <- clean[nrow(clean),]
day <- today$date
new_pos <- today$New.Positive
percent_pos <- round(clean$New.Percent.Positive[nrow(clean)]*100, digits = 1)
# percent_pos <- today$New.Percent.Positive
percent_pos7 <- round(clean$Week.Positivity.Rate[nrow(clean)-4]*100, digits = 1)
percent_hospital <- round(clean$Percent.Hospitalized[nrow(clean)], digits = 1)
# percent_hospital <- clean$Percent.Hospitalized[nrow(clean)]
ICU <- today$ICU
percent_ICU <- round(today$ICU/today$hospitalized*100, digits = 1)
sick <- format(today$Still.Sick, scientific = FALSE, big.mark=",")
IowaPop <- 3155070
clean = clean %>% mutate(
Individuals.Reported = Individuals.Tested - lag(Individuals.Tested),
Individuals.Positive = Individuals.Postive - lag(Individuals.Postive),
Bremer.Rep = Bremer.Individuals.Tested - lag(Bremer.Individuals.Postive))
# Adding more data to Bremer
hosp <- as.integer(hospital[,"Bremer"])
temp <- clean %>% select("date","Bremer.Positive",
"Bremer.Recovered", "Bremer.Death")
names(temp) = c("date","Positive", "Recovered", "Deaths")
temp <- subset(temp,
!is.na(Positive) & date < "2020-07-31")%>%
mutate(Tested = NA, Hospitalized = NA)
temp2 <- BremerData %>% select("date","Hospitalized", "Tested","Positive", "Recovered", "Deaths")
temp = rbind(temp, temp2)
rm(temp2)
temp$Tested = as.integer(temp$Tested)
temp <- temp  %>%
mutate(
Active = Positive - Recovered - Deaths,
New.Pos = Positive - lag(Positive),
New.Test = Tested - lag(Tested),
New.Rec = Recovered - lag(Recovered),
New.Deaths = Deaths - lag(Deaths),
Frac.Pos = New.Pos/New.Test,
Day7.Test = Tested - lag(Tested, n=7),
Day7.Pos = Positive - lag(Positive, n=7),
Day7.Rec = Recovered - lag(Recovered, n=7),
Day7.Death = Deaths - lag(Deaths, n=7),
Day7.Active = Active - lag(Active, n=7),
Day7.Perc = Day7.Pos/Day7.Test,
Day14.Test = Tested - lag(Tested, n=14),
Day14.Pos = Positive - lag(Positive, n=14),
Day14.Rec = Recovered - lag(Recovered, n=14),
Day14.Death = Deaths - lag(Deaths, n=14),
Day14.Active = Active - lag(Active, n=14),
Day14.Perc = Day14.Pos/Day14.Test,
Not.Sick = (lag(Positive, n= 10) -
lag(Positive, n=28))*0.7,
True.Active = Positive - Recovered -
Deaths - round(Not.Sick, digits = 0)
)
BremerData = temp
rm(temp)
write.csv(BremerData, "CountyData/BremerData.csv")
maxtoday = data.frame(colMax(clean[,-1]) == today[,-1])
temp = subset(clean, date == (day-365))
oldactive = temp$positive-temp$Recovered-temp$deaths
rm(temp)
pactive <- qplot(date, Still.Sick, data = clean[-(1:23),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Iowa")
png(paste(day,"pactive.png"))
pactive
dev.off()
pactive
ppositive <-qplot(date, New.Percent.Positive, data = clean[-(1:7),], geom = c("point", "smooth")) + ylab("Fraction Positive") +
ggtitle("Fraction of Positive COVID-19 Tests in Iowa")
png(paste(day,"ppositive.png"))
ppositive
dev.off()
ppositive
p7positive <-qplot(date, Week.Positivity.Rate, data = clean[-(1:20),], geom = c("point", "smooth")) + ylab("Fraction Positive") +
ggtitle("7 day average of Fraction of Positive COVID-19 Tests in Iowa")
png(paste(day,"p7positive.png"))
p7positive
dev.off()
p7positive
State_Average_Active <- today$Still.Sick/IowaPop*100000
Bremer_Population <- county[county$COUNTY=="Bremer",][,3]
Butler_Population <- county[county$STATE=="Iowa"&county$COUNTY=="Butler",][,3]
BlackHawk_Population <- county[county$STATE=="Iowa"&county$COUNTY=="Black Hawk",][,3]
pBremer <-qplot(date,
#Butler.SS/Butler_Population*100000,
Bremer.SS,
data = clean[-(1:116),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Bremer County")
#    "Known Active COVID-19 Cases in Bremer County")
#+  geom_hline(aes(yintercept=State_Average_Active)
pButler <-qplot(date,
#Butler.SS/Butler_Population*100000,
Butler.SS,
data = clean[-(1:116),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Butler County")
ggtitle("Known Active COVID-19 Cases in Butler County Per 100,000 People")
#+  geom_hline(aes(yintercept=State_Average_Active)
png(paste(day,"pButler.png"))
pButler
dev.off()
pButler
pBlackHawk <-qplot(date,
#Butler.SS/Butler_Population*100000,
BlackHawk.SS,
data = clean[-(1:116),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Black Hawk County")
png(paste(day,"pBlackHawk.png"))
pBlackHawk
dev.off()
pBlackHawk
png(paste(day,"pBremer.png"))
pBremer
dev.off()
pBremer
day7pos.Bremer <- round(
BremerData[nrow(BremerData), ncol(BremerData)]*100, digits=1)
require(knitr)
colMax <- function(data) sapply(data, max, na.rm = TRUE)
Bremer_Population <- county[county$COUNTY=="Bremer",][,3]
Butler_Population <- county[county$STATE=="Iowa"&county$COUNTY=="Butler",][,3]
BlackHawk_Population <- county[county$STATE=="Iowa"&county$COUNTY=="Black Hawk",][,3]
Bremerlastrow <- BremerData[nrow(BremerData),]
Black.Hawklastrow <- Black.HawkData[nrow(Black.HawkData),]
Butlerlastrow <- ButlerData[nrow(ButlerData),]
# AC = as.integer(lastrow["Active"])
# H = as.integer(lastrow["Hospitalized"])
# NP = as.integer(lastrow["New.Pos"])
# PR = as.numeric(round(lastrow["Frac.Pos"]*100, digits = 2))
# ND = as.integer(lastrow["New.Deaths"])
# T = as.integer(lastrow["New.Test"])
Brtemp = data.frame(colMax(BremerData) == Bremerlastrow)
BHtemp = data.frame(colMax(Black.HawkData) == Black.Hawklastrow)
Butemp = data.frame(colMax(ButlerData) == Butlerlastrow)
todaytemp = data.frame(colMax(clean[,-1]) == today[,-1])
###########Risk Calculation#####################
groupsize = 15
Risk = data.frame(Bremer.Prob = Bremerlastrow$Active/Bremer_Population , Black.Hawk.Prob = Black.Hawklastrow$Active/BlackHawk_Population, Butler.Prob = Butlerlastrow$Active/Butler_Population)
Risk = Risk %>% mutate(
Bremer.Risk = 1-(1-Bremer.Prob*5)^groupsize,
Black.Hawk.Risk = 1-(1-Black.Hawk.Prob*5)^groupsize,
Butler.Risk = 1-(1-Butler.Prob*5)^groupsize
)
require(reshape2)
mydate <- Sys.Date()
Bremer_Population <- county[county$COUNTY=="Bremer",][,3]
Butler_Population <- county[county$STATE=="Iowa"&county$COUNTY=="Butler",][,3]
BlackHawk_Population <- county[
county$STATE=="Iowa"&county$COUNTY=="Black Hawk",
][,3]
temp = clean[,c("date","Bremer.SS", "Butler.SS", "BlackHawk.SS")]
temp = temp %>% mutate(Bremer = Bremer.SS/Bremer_Population*100000,
Butler = Butler.SS/Butler_Population* 100000,
BlackHawk = BlackHawk.SS/BlackHawk_Population * 100000)
temp = temp[-(1:(nrow(temp)-100)),]
mtemp = melt(temp, id.vars = "date",
measure.vars = c('Bremer', 'Butler', 'BlackHawk'))
printplot <- qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))
print(printplot)
png("BBBCounties.png")
printplot
dev.off()
# colnames(BremerData) = CountyDataLongNames
lastrow <- BremerData[nrow(BremerData),]
kable(t(lastrow[-1]), digits = 2)
kable(BremerData[,1:7])
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
subset(BremerData, date == (day-365))$New.Pos/Bremer_Population,
na.rm = FALSE,
show.legend = NA
)
year_reference = subset(BremerData, date == (day-365))$New.Pos/Bremer_Population
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA
)
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA
)+
geom_text(aes(0, year_reference, label = "Last Year", vjust = - 1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_text(aes(0, year_reference, label = "Last Year", vjust = - 1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_text(aes(x=(day-365), y=year_reference, label = "Last Year", vjust = - 1))
View(temp)
temp$date[1]
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_text(aes(x=temp$date[1], y=year_reference, label = "Last Year", vjust = - 1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = 0))
year_reference
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year Bremer", vjust = -.5, color = 'red'))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference,  vjust = -.5, color = 'Bremer One Year Ago'))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = " ", vjust = -.5, color = 'red'))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA,
)
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA, color = "Bremer One Year Ago"
)
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
show.legend = NA, color = "red"
)
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1))
printplot <- qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1, color = red))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1, color = red))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1, color = "red"))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1, color = "Last Year"))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1, colour = "Last Year"))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, colour = "Last Year", label = "Last Year", vjust = - 1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, colour = factor(measure.vars), label = "Last Year", vjust = - 1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)+     geom_text(aes(x=(temp$date[1]+10), y=year_reference, label = "Last Year", vjust = - 1, color = "Bremer Last Year"))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(
yintercept = year_reference,
na.rm = FALSE,
color = "red"
)
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference)
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference, label = "One Year Ago")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(, label = "One Year Ago")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text( label = "One Year Ago")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(x= temp$date[1], y= year_reference, label = "One Year Ago")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference+10) + geom_text(x= temp$date[1], y= year_reference, label = "One Year Ago")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(x= temp$date[1]+10, y= year_reference, label = "One Year Ago")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(x= temp$date[1]+20, y= year_reference, label = "One Year Ago")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(x= temp$date[1]+20, y= year_reference+10, label = "One Year Ago")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(x= temp$date[1]+20, y= year_reference, label = "One Year Ago", hjust = 1)
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(x= temp$date[1]+20, y= year_reference, label = "One Year Ago", hjust = -1)
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = "One Year Ago", hjust = -1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = "One Year Ago", vjust = -1))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = "One Year Ago", vjust = -0.5))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(
aes(x= temp$date[1]+20, y= year_reference, colour = "red", label = "One Year Ago", vjust = -0.5))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(
aes(x= temp$date[1]+20, y= year_reference, colour = "red", label = "One Year Ago", vjust = -0.5, show.legend = FALSE))
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = "One Year Ago", vjust = -0.5), colour = "red")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference) + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = "One Year Ago", vjust = -0.5), colour = "Bremer")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference, color = "red") + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = "One Year Ago", vjust = -0.5), colour = "red")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference, color = "red") + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = day-365, vjust = -0.5), colour = "red")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference, color = "red") + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = day-365, vjust = -0.5), colour = "black")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth"))+geom_hline(yintercept = year_reference, color = "red") + geom_text(
aes(x= temp$date[1]+20, y= year_reference, label = day-365, vjust = -0.5), colour = "black")+
printplot <- qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(yintercept = year_reference,
color = "red") +
geom_text(
aes(x= temp$date[1]+20, y= year_reference,
label = day-365, vjust = -0.5),
colour = "black")
qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(yintercept = year_reference,
color = "red") +
geom_text(
aes(x= temp$date[1]+20, y= year_reference,
label = day-365, vjust = -0.5),
colour = "black")
printplot <- qplot(date, value, color = variable, data = mtemp, geom = c("point", "smooth")) +
ylab("Cases per 100,000") +
labs(color = "County", title = paste("Active Cases Per 100,000", mydate))+
geom_hline(yintercept = year_reference,
color = "red") +
geom_text(
aes(x= temp$date[1]+20, y= year_reference,
label = day-365, vjust = -0.5),
colour = "black")
printplot
qplot(date, Still.Sick, data = clean[-(1:23),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Iowa")
qplot(date, Still.Sick, data = clean[-(1:23),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Iowa") + geom_hline(yyintercept = oldactive)
qplot(date, Still.Sick, data = clean[-(1:23),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Iowa") + geom_hline(yintercept = oldactive)
qplot(date, Still.Sick, data = clean[-(1:23),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Iowa") + geom_hline(yintercept = oldactive, color = "red")
pactive <- qplot(date, Still.Sick, data = clean[-(1:23),], geom = c("point", "smooth")) +
ggtitle("Known Active COVID-19 Cases in Iowa") +  geom_hline(yintercept = oldactive, color = "red")
pactive
