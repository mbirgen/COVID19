inpatientSave$date[nrow(inpatientSave)] = as.character(date)
}
inpatientSave = inpatientSave %>% unique() %>%
mutate(total_ICU= staffed_icu_adult_patients_confirmed_covid +
staffed_icu_pediatric_patients_confirmed_covid)
write.csv(inpatientSave, "HospitalData.csv",row.names = FALSE)
covid19[covid19$date == as.Date(date),c("hospitalized",
"new.hospital","ICU")] =
inpatient[c("inpatient_beds_used_covid",
"previous_day_admission_adult_covid_confirmed",
"staffed_icu_adult_patients_confirmed_and_suspected_covid")]
covid19[covid19$date == as.Date(date),"Admit"] =
sum((inpatient %>% select(contains("previous_day")))[1:4])
covid19 = covid19 %>% unique()
write.csv(covid19, "covid19.csv",row.names = FALSE, na="")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
install.packages("taskscheduleR")
require(taskscheduleR)
require(taskscheduleR)
install.packages("miniUI")
taskscheduleR:::taskschedulerAddin()
install.packages(c("BH", "bit", "blob", "broom", "bslib", "cachem", "callr", "cli", "colorspace", "cpp11", "crayon", "curl", "data.table", "dbplyr", "digest", "dplyr", "dtplyr", "evaluate", "fansi", "fastmap", "forcats", "fs", "gargle", "ggplot2", "gh", "googledrive", "googlesheets4", "gtable", "haven", "highr", "hms", "htmltools", "httr", "isoband", "jsonlite", "knitr", "lifecycle", "lubridate", "markdown", "modelr", "openssl", "pdftools", "pillar", "plyr", "processx", "ps", "purrr", "qpdf", "Rcpp", "readr", "readxl", "reprex", "rlang", "rmarkdown", "rstudioapi", "rvest", "sass", "scales", "stringi", "stringr", "sys", "tibble", "tidyr", "tidyselect", "tidyverse", "tinytex", "utf8", "vctrs", "viridisLite", "vroom", "xfun", "yaml", "zoo"))
install.packages(c("BH", "bit", "blob", "broom", "bslib", "cachem", "callr", "cli", "colorspace", "cpp11", "crayon", "curl", "data.table", "dbplyr", "digest", "dplyr", "dtplyr", "evaluate", "fansi", "fastmap", "forcats", "fs", "gargle", "ggplot2", "gh", "googledrive", "googlesheets4", "gtable", "haven", "highr", "hms", "htmltools", "httr", "isoband", "jsonlite", "knitr", "lifecycle", "lubridate", "markdown", "modelr", "openssl", "pdftools", "pillar", "plyr", "processx", "ps", "purrr", "qpdf", "Rcpp", "readr", "readxl", "reprex", "rlang", "rmarkdown", "rstudioapi", "rvest", "sass", "scales", "stringi", "stringr", "sys", "tibble", "tidyr", "tidyselect", "tidyverse", "tinytex", "utf8", "vctrs", "viridisLite", "vroom", "xfun", "yaml", "zoo"))
install.packages(c("BH", "bit", "blob", "broom", "bslib", "cachem", "callr", "cli", "colorspace", "cpp11", "crayon", "curl", "data.table", "dbplyr", "digest", "dplyr", "dtplyr", "evaluate", "fansi", "fastmap", "forcats", "fs", "gargle", "ggplot2", "gh", "googledrive", "googlesheets4", "gtable", "haven", "highr", "hms", "htmltools", "httr", "isoband", "jsonlite", "knitr", "lifecycle", "lubridate", "markdown", "modelr", "openssl", "pdftools", "pillar", "plyr", "processx", "ps", "purrr", "qpdf", "Rcpp", "readr", "readxl", "reprex", "rlang", "rmarkdown", "rstudioapi", "rvest", "sass", "scales", "stringi", "stringr", "sys", "tibble", "tidyr", "tidyselect", "tidyverse", "tinytex", "utf8", "vctrs", "viridisLite", "vroom", "xfun", "yaml", "zoo"))
taskscheduleR:::taskschedulerAddin()
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
source("HospitalData.R")
install.packages(c("cli", "colorspace", "fansi", "purrr", "rlang", "utf8"))
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(DT$date-(date-D)) ==
min(abs(DT$date-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
require(plyr)
require(dplyr)
require(lubridate)
require(tidyverse)
require(anytime)
temp <- inpatientSave[,-1]
library(dplyr)
temp %>%
mutate(row_num = 1:n(), is_dup = duplicated(temp)) %>%
group_by(across(-c(row_num, is_dup))) %>%
mutate(
has_copies = n() > 1L,
which_row = if_else(is_dup, first(row_num), NA_integer_),
row_num = NULL, is_dup = NULL
)
temp<-
temp %>%
mutate(row_num = 1:n(), is_dup = duplicated(temp)) %>%
group_by(across(-c(row_num, is_dup))) %>%
mutate(
has_copies = n() > 1L,
which_row = if_else(is_dup, first(row_num), NA_integer_),
row_num = NULL, is_dup = NULL
)
View(temp)
temp1 <- subset(temp, has_copies != TRUE & which_row >0 )
View(temp1)
temp1 <- subset(temp, has_copies != TRUE )
temp1 <- subset(temp, is.na(which_row) )
duplicated(inpatientSave[,-1])
inpatientSave[!duplicated(inpatientSave[,-1]),]
temp <- inpatientSave[!duplicated(inpatientSave[,-1]),]
rm(temp1)
tail(temp[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
inpatientSave <- read.csv("HospitalData.csv", stringsAsFactors = FALSE)
temp <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(temp[,c("date","inpatient_beds_used_covid")],7)
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
write.csv(inpatientSave, "HospitalData.csv",row.names = FALSE)
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(DT$date-(date-D)) ==
min(abs(DT$date-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
require(plyr)
require(dplyr)
require(lubridate)
require(tidyverse)
require(anytime)
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
URL ="https://healthdata.gov/api/views/6xf2-c3ie/rows.csv"
inpatient = read.csv(URL, na.strings = c("-999999","-999999.0"))
inpatient = inpatient %>% filter(state == "IA") %>%
select(contains("covid")) %>% select(-contains("coverage"))
temp = cbind(date =as.Date(date), inpatient)
inpatientSave <- read.csv("HospitalData.csv", stringsAsFactors = FALSE)
# inpatientSave = read.csv("HospitalData.csv")
# HospitalFed = as.data.frame(temp)
# HospitalFed = rbind(HospitalFed, temp)
str(inpatient)
str(temp)
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(DT$date-(date-D)) ==
min(abs(DT$date-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
inpatientSave = inpatientSave %>% unique() %>%
mutate(total_ICU= staffed_icu_adult_patients_confirmed_covid +
staffed_icu_pediatric_patients_confirmed_covid)
write.csv(inpatientSave, "HospitalData.csv",row.names = FALSE)
covid19[covid19$date == as.Date(date),c("hospitalized",
"new.hospital","ICU")] =
inpatient[c("inpatient_beds_used_covid",
"previous_day_admission_adult_covid_confirmed",
"staffed_icu_adult_patients_confirmed_and_suspected_covid")]
covid19[covid19$date == as.Date(date),"Admit"] =
sum((inpatient %>% select(contains("previous_day")))[1:4])
covid19 = covid19 %>% unique()
write.csv(covid19, "covid19.csv",row.names = FALSE, na="")
tail(covid19[,1:5])
tail(covid19[,1:10])
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(DT$date-(date-D)) ==
min(abs(DT$date-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
closestdate(inpatientSave,7)
inpatientSave$date
date
date-7
D=7
DT = inpatientSave
abs(DT$date-(date-D)) ==
min(abs(DT$date-date+D)
)
DT$date-(date-D)
(date-D)
str(date-D)
str(DT$date)
str(inpatientSave$date)
as.Date(inpatientSave$date)
anydate(inpatientSave$date)
anydate(DT$date)-(date-D)
abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D))
oneyearago = closestdate(covid19,365)
oneweekago = closestdate(inpatientSave,7)
anydate(DT$date)-(date-D)
min(abs(anydate(DT$date)-date+D))
abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D))
which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
length(inpatientSave)-which(abs(anydate(DT$date)-(date-D)) ==
+           min(abs(anydate(DT$date)-date+D)))
length(inpatientSave)
nrow(inpatientSave)
nrow(inpatientSave) - which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
D = 30
nrow(inpatientSave) - which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
oneweekago = closestdate(inpatientSave,7)
closestdate <- function(DT, D){
which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
}
oneweekago = closestdate(inpatientSave,7)
tail_oneweekago = nrow(inpatientSave) - oneweekago
tail_onemonthago = nrow(inpatientSave) - closestdate(inpatientSave,30)
sum(tail(inpatientSave$deaths_covid, n=tail_onemonthago))
sum(tail(inpatientSave$deaths_covid, n=tail_oneweekago))
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
oneweekago = closestdate(inpatientSave,7)
tail_oneweekago = nrow(inpatientSave) - oneweekago
tail_onemonthago = nrow(inpatientSave) - closestdate(inpatientSave,28)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
oneweekago = closestdate(inpatientSave,7)
tail_oneweekago = nrow(inpatientSave) - oneweekago
tail_onemonthago = nrow(inpatientSave) - closestdate(inpatientSave,28)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
oneweekago = closestdate(inpatientSave,7)
tail_oneweekago = nrow(inpatientSave) - oneweekago
tail_onemonthago = nrow(inpatientSave) - closestdate(inpatientSave,28)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
oneweekago = closestdate(inpatientSave,7)
tail_oneweekago = nrow(inpatientSave) - oneweekago
tail_onemonthago = nrow(inpatientSave) - closestdate(inpatientSave,28)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
oneweekago = closestdate(inpatientSave,7)
tail_oneweekago = nrow(inpatientSave) - oneweekago
tail_onemonthago = nrow(inpatientSave) - closestdate(inpatientSave,28)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
tail(covid19[,1:5],7)
date = Sys.Date()
covid19 <- read.csv("covid19.csv",
stringsAsFactors = FALSE)
names(covid19)[1] <- "date"
require(anytime)
closestdate <- function(DT, D){
which(abs(anydate(DT$date)-(date-D)) ==
min(abs(anydate(DT$date)-date+D)))
}
covid19$date = anydate(covid19$date)
oneyearago = closestdate(covid19,365)
twoyearago = closestdate(covid19,730)
oneweekago = closestdate(inpatientSave,7)
tail_oneweekago = nrow(inpatientSave) - oneweekago
tail_onemonthago = nrow(inpatientSave) - closestdate(inpatientSave,28)
# inpatientSave = inpatientSave[-nrow(inpatientSave),]
source("HospitalData.R")
inpatientSave <- inpatientSave[!duplicated(inpatientSave[,-1]),]
tail(inpatientSave[,c("date","inpatient_beds_used_covid")],7)
covid19$date = anydate(covid19$date)
# qplot(date, hospitalized,
ggplot(data = tail(covid19, n=80), aes(date, hospitalized)) + geom_point() +geom_smooth(span = 0.3, se = TRUE)
##############################################
mergedYearonYearHospMeans = covid19 %>%
drop_na(hospitalized) %>%
select("date","hospitalized") %>%
mutate(week = week(date),
year = as.factor(year(date))) %>%
group_by(year, week) %>%
summarise_at(vars(hospitalized), list(WeeklyAve = mean))
ggplot(data=mergedYearonYearHospMeans, aes(week, WeeklyAve, color = year)) + geom_point()+geom_smooth(span = 0.5, se = TRUE)  + xlab("Week of Year")+ ylab("Weekly Average Hospitalized")
tail(covid19[,1:5],7)
